(()=>{var C=Object.defineProperty;var u=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var m=(t,e,i)=>e in t?C(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,c=(t,e)=>{for(var i in e||(e={}))A.call(e,i)&&m(t,i,e[i]);if(u)for(var i of u(e))k.call(e,i)&&m(t,i,e[i]);return t};var p={idEmbedContainer:"embed-container",idPosterContainer:"poster-container",idSpinnerContainer:"spinner-container",idPosterImg:"poster-img",idBtnPlay:"btn-play",activeIframeClass:"isactive",textVideoTitle:"Video da Youtube",textVideoDescription:"Guarda questo video incorporato nel sito da Youtube",textMissingVideoId:"ID video errato o mancante",textBtn:"Riproduci",textVideo:"video",spinnerColor:"#ff0000",videoStartAt:0,posterQuality:"hqdefault"};var b=()=>{let t=new CSSStyleSheet;return t.replaceSync(` :host, :host *, :host *::before, :host *::after { box-sizing: border-box; } :host { contain: content; display: block; width: 100%; aspect-ratio: var(--aspect-ratio); --aspect-ratio: var(--embed-youtube-aspect-ratio, 16 / 9); --aspect-ratio-short: var(--embed-youtube-aspect-ratio-short, 9 / 16); } @media (max-width: 40em) { :host([short]) { aspect-ratio: var(--aspect-ratio-short); } } #embed-container { position: relative; width: 100%; height: 100%; aspect-ratio: 16 / 9; overflow: hidden; cursor: pointer; } #embed-container.isactive::before, #embed-container.isactive > #btn-play { display: none; } iframe, #poster-img { position: absolute; width: 100%; height: 100%; inset: 0; } iframe { border: 0; } #poster-img { object-fit: cover; box-sizing: border-box; } #btn-play { width: 68px; height: 48px; z-index: 1; border: 0; background-color: transparent; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 48"><path d="M66.52 7.74c-.78-2.93-2.49-5.41-5.42-6.19C55.79.13 34 0 34 0S12.21.13 6.9 1.55c-2.93.78-4.63 3.26-5.42 6.19C.06 13.05 0 24 0 24s.06 10.95 1.48 16.26c.78 2.93 2.49 5.41 5.42 6.19C12.21 47.87 34 48 34 48s21.79-.13 27.1-1.55c2.93-.78 4.64-3.26 5.42-6.19C67.94 34.95 68 24 68 24s-.06-10.95-1.48-16.26z" fill="red"/><path d="M45 24 27 14v20" fill="white"/></svg>'); background-repeat: no-repeat; background-position: center; background-size: 100% 100%; } #btn-play:before { content: ""; border-style: solid; border-width: 10px 0 10px 16px; border-color: transparent transparent transparent #fff; } #btn-play, #btn-play:before, #error-message { position: absolute; top: 50%; left: 50%; text-align: center; transform: translate3d(-50%, -50%, 0); cursor: inherit; } #error-message { width: 100%; } .isactive { cursor: unset; } #spinner-container { position: absolute; top: 50%; left: 50%; transform: translate3d(-50%, -50%, 0); } `),t};var g=t=>{let{config:e}=t;t.attachShadow({mode:"open"}),t.shadowRoot.adoptedStyleSheets=[b()],t.shadowRoot.innerHTML=`<div id="${e.idEmbedContainer}"><div id="${e.idSpinnerContainer}" part="spinner"><svg width="60" height="60" viewBox="0 0 44 44"><circle cx="50%" cy="50%" r="20" fill="none" stroke="#E5E7EB" stroke-width="4"></circle><circle cx="50%" cy="50%" r="20" fill="none" stroke="${e.spinnerColor}" stroke-width="4" stroke-dasharray="125.6" stroke-dashoffset="125.6"><animate attributeName="stroke-dashoffset" values="125.6;0" dur="1.5s" repeatCount="indefinite"></animate></circle></svg></div><picture id="${e.idPosterContainer}"><img id="${e.idPosterImg}" part="poster" referrerpolicy="origin" loading="lazy" alt=""></picture><button id="${e.idBtnPlay}" part="play-button" hidden></button></div>`,t.domContainer=t.shadowRoot.getElementById(e.idEmbedContainer),t.domPosterContainer=t.shadowRoot.getElementById(e.idPosterContainer),t.domImgPoster=t.shadowRoot.getElementById(e.idPosterImg),t.domPlayButton=t.shadowRoot.getElementById(e.idBtnPlay)};var h=(()=>{let t=!1,e=(i,s)=>{let r=document.createElement("link");r.rel=i,r.href=s,r.crossOrigin="true",document.head.append(r)};return i=>{t||i.noPreconnect||i.globalNoPreconnect||(e("preconnect","https://i.ytimg.com/"),e("preconnect","https://s.ytimg.com"),i.noCookie?e("preconnect","https://www.youtube-nocookie.com"):(e("preconnect","https://www.youtube.com"),e("preconnect","https://www.google.com"),e("preconnect","https://googleads.g.doubleclick.net"),e("preconnect","https://static.doubleclick.net")),t=!0)}})(),f=t=>{if(!t)return"";let e=decodeURIComponent(t);if(/^(?:https?:\/\/|www\.)/.test(t)){if(e.includes("youtube.com")||e.includes("youtu.be"))try{return new URL(e).pathname.split("/").pop()||""}catch(s){return""}return""}return e},y=t=>{if(!t.videoId||t.videoId===""){l(t.shadowRoot.getElementById(t.config.idSpinnerContainer),!0);let e=document.createElement("h2");return e.id="error-message",e.textContent=t.config.textMissingVideoId,t.domContainer.appendChild(e),!0}return!1},v=t=>{let{config:e}=t,{videoId:i}=t,s=t.videoTitle||e.textVideoTitle,r=t.description||e.textVideoDescription,o=t.playlistId?`?listType=playlist&list=${t.playlistId}`:`${i}`,a=document.createElement("script");a.id=`json-${i}`,a.type="application/ld+json",a.text=JSON.stringify({"@context":"https://schema.org","@type":"VideoObject",name:`${s}`,description:`${r}`,thumbnailUrl:`https://i.ytimg.com/vi/${i}/hqdefault.jpg`,contentUrl:`https://www.youtube.com/watch?v=${i}`,embedUrl:`https://www.youtube.com/embed/${o}`}),t.prepend(a)},w=t=>{let{config:e}=t;return t.playText&&t.videoTitle?`${t.playText} ${t.videoTitle}`:t.playText?t.playText:t.videoTitle?`${e.textBtn} ${t.videoTitle}`:`${e.textBtn} ${e.textVideo}`},l=(t,e=!0,i=250)=>{e?t.hidden=!0:setTimeout(()=>{t.hidden=!1},i)};/**
* @preserve
* Filename: embed-youtube.js
*
* Created: 05/05/2025 (12:08:23)
* Created by: Lorenzo Saibal Forti <lorenzo.forti@gmail.com>
*
* Last update: 16/07/2025 (16:45:38)
* Updated by: Lorenzo Saibal Forti <lorenzo.forti@gmail.com>
*
* Copyleft: 2025 - Tutti i diritti riservati
*
* Comments:
*/(()=>{"use strict";let t=document.currentScript||document.getElementsByTagName("body")[0];class e extends HTMLElement{constructor(){super(),this.config=c(c({},p),window.embedYoutubeConfig||{}),this.scheduleUpdate,this.isIframeLoaded=!1,this.globalParam=t,g(this)}static get observedAttributes(){return["video-id","playlist-id","video-title","play-text","poster-url","poster-fallback","short","mute"]}connectedCallback(){y(this)||(this.setupComponent(),this.addEventListener("click",()=>{this.loadIframe()}),this.addEventListener("pointerover",()=>{h(this)},{once:!0}))}get videoId(){let s=this.getAttribute("video-id")||"",r=f(s);return encodeURIComponent(r)}get playlistId(){return encodeURIComponent(this.getAttribute("playlist-id")||"")}get videoTitle(){return this.getAttribute("video-title")||this.config.textVideoTitle}get description(){return this.getAttribute("description")}get playText(){return this.getAttribute("play-text")}get videoStartAt(){return this.getAttribute("video-start-at")||this.config.videoStartAt}get autoLoadMargin(){return this.getAttribute("autoload-margin")||"0px"}get posterUrl(){return this.getAttribute("poster-url")}get posterQuality(){return this.getAttribute("poster-quality")||this.config.posterQuality}get paramList(){return this.getAttribute("param-list")}isYouTubeShort(){return this.getAttribute("short")===""&&window.matchMedia("(max-width: 40em)").matches}get autoLoad(){return this.hasAttribute("autoload")||this.globalParam.hasAttribute("data-autoload")}get autoPlay(){return this.hasAttribute("autoplay")||this.globalParam.hasAttribute("data-autoplay")}get mute(){return this.hasAttribute("mute")||this.globalParam.hasAttribute("data-mute")}get autoPause(){return this.hasAttribute("autopause")||this.globalParam.hasAttribute("data-autopause")}get noCookie(){return this.hasAttribute("no-cookie")||this.globalParam.hasAttribute("data-no-no-cookie")}get noSchema(){return this.hasAttribute("no-schema")||this.globalParam.hasAttribute("data-no-schema")}get noPreconnect(){return this.hasAttribute("no-preconnect")||this.globalParam.hasAttribute("data-no-preconnect")}get noLazyLoad(){return this.hasAttribute("no-lazyload")}get posterFallback(){return this.hasAttribute("poster-fallback")}setupComponent(){let s=w(this);this.domPlayButton.setAttribute("aria-label",s),this.setAttribute("title",s),this.domImgPoster.src="",this.noLazyLoad&&this.domImgPoster.removeAttribute("loading"),this.posterFallback?this.setPosterFallback():this.posterUrl?this.setPosterCustom():this.setPoster(),(this.autoLoad||this.isYouTubeShort())&&this.autoLoadIframe(),this.autoPause&&this.autoPauseVideo(),this.noSchema||v(this)}createIframe(){let s=this.noCookie?"-nocookie":"",r=this.playlistId?`?listType=playlist&list=${this.playlistId}&`:`${this.videoId}?`,o;if(this.paramList&&this.paramList!=="")o=this.paramList;else{let n=this.autoPlay||this.autoPause||this.isYouTubeShort()?1:0,d=this.autoLoad&&!this.autoPlay?0:1,I=this.mute?1:0,P=this.videoStartAt;o=`enablejsapi=${n}&autoplay=${d}&start=${P}`,d&&this.autoLoad?o=`${o}&mute=1`:o=`${o}&mute=${I}`,this.isYouTubeShort()&&(o=`${o}&loop=1&modestbranding=1&playsinline=1&rel=0&playlist=${this.videoId}`)}return`<iframe title="${this.videoTitle}" credentialless allow="accelerometer;autoplay;encrypted-media;gyroscope;picture-in-picture" allowfullscreen src="https://www.youtube${s}.com/embed/${r}${o}"></iframe>`}loadIframe(){if(!this.isIframeLoaded){let s=this.createIframe();this.domContainer.insertAdjacentHTML("beforeend",s),this.domContainer.classList.add(this.config.activeIframeClass),this.isIframeLoaded=!0,this.dispatchEvent(new CustomEvent("embedYoutubeLoaded",{detail:{videoId:this.videoId,playlistId:this.playlistId,videoTitle:this.videoTitle,posterUrl:this.posterUrl},bubbles:!0,cancelable:!0}))}}autoLoadIframe(){let s={root:null,rootMargin:this.autoLoadMargin,threshold:0};new IntersectionObserver((o,a)=>{o.forEach(n=>{n.isIntersecting&&!this.isIframeLoaded&&(h(this),this.loadIframe(!0),a.unobserve(this))})},s).observe(this)}autoPauseVideo(){new IntersectionObserver(r=>{r.forEach(o=>{var a,n;o.isIntersecting||(n=(a=this.shadowRoot.querySelector("iframe"))==null?void 0:a.contentWindow)==null||n.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")})},{threshold:0}).observe(this)}setPosterFallback(){var o,a;let s=`<svg part="poster-fallback" xmlns="http://www.w3.org/2000/svg" viewBox="0 48 294 198" width="294" height="198"><path d="M294,48 c0-8.284-6.716-15-15-15H15 C6.716,33,0,39.716,0,48v198 c0,8.284,6.716,15,15,15h264 c8.284,0,15-6.716,15-15V48z" fill="red"/><path transform="translate(0,6)" d="M124,113.134 c0-2.68,1.596-5.155,3.917-6.495 c2.32-1.34,5.263-1.34,7.583,0 l37.046,21.364 c2.32,1.34,3.771,3.815,3.771,6.495 s-1.419,5.155-3.74,6.495 l-36.999,21.364 c-1.16,0.67-2.452,1.005-3.747,1.005 s-2.755-0.335-3.915-1.005 c-2.32-1.34-3.915-3.815-3.915-6.495V113.134z" fill="white"/><path transform="translate(0,-30)" d="M263.333,232H89v1 c0,4.143-3.357,7.5-7.5,7.5 S74,237.143,74,233v-1 H30.333 c-4.143,0-7.5-3.357-7.5-7.5 s3.357-7.5,7.5-7.5h44 c0-4.143,3.357-7.5,7.5-7.5 s7.5,3.357,7.5,7.5h174 c4.143,0,7.5,3.357,7.5,7.5 S267.476,232,263.333,232z" fill="white"/><text x="147" y="95" fill="white" font-family="Verdana, sans-serif" font-size="18" font-weight="bold" text-anchor="middle">Play video</text></svg>`;this.getAttribute("poster-fallback")||this.setAttribute("poster-fallback",""),l(this.domPlayButton,!0),this.domPlayButton.setAttribute("aria-hidden","true"),(o=this.domPosterContainer.querySelector("#img-webp"))==null||o.remove(),(a=this.domPosterContainer.querySelector("#img-jpg"))==null||a.remove();let r=`data:image/svg+xml;charset=UTF-8,${encodeURIComponent(s)}`;this.domImgPoster.src=r,this.domImgPoster.removeAttribute("loading"),this.domImgPoster.setAttribute("alt","")}setPosterCustom(){this.domImgPoster.src=this.posterUrl,this.domImgPoster.onload=()=>{this.posterFallback||(this.domImgPoster.setAttribute("alt",this.videoTitle),l(this.domPlayButton,!1))},this.domImgPoster.onerror=()=>{this.posterUrl&&this.setPosterFallback()}}setPoster(){let s=`https://i.ytimg.com/vi_webp/${this.videoId}/${this.posterQuality}.webp`,r=`https://i.ytimg.com/vi/${this.videoId}/${this.posterQuality}.jpg`,o=new Image;o.src=s,o.onload=()=>{if(o.naturalWidth===120&&o.naturalHeight===90)return this.setPosterFallback();let n=document.createElement("source");n.id="img-webp",n.setAttribute("type","image/webp");let d=document.createElement("source");d.id="img-jpg",d.setAttribute("type","image/jpeg"),this.domPosterContainer.prepend(n,d),this.domPosterContainer.querySelector("#img-webp").srcset=s,this.domPosterContainer.querySelector("#img-jpg").srcset=r,this.domImgPoster.src=r,l(this.domPlayButton,!1)}}attributeChangedCallback(s,r,o){if(r===null||r===o)return;this.scheduleUpdate&&cancelAnimationFrame(this.scheduleUpdate);let a=s==="video-id"?r:this.videoId;!this.noSchema&&this.querySelector(`#json-${a}`)&&this.querySelector(`#json-${a}`).remove(),this.scheduleUpdate=requestAnimationFrame(()=>{this.domContainer.classList.contains(this.config.activeIframeClass)&&(this.domContainer.classList.remove(this.config.activeIframeClass),this.shadowRoot.querySelector("iframe").remove(),this.isIframeLoaded=!1),this.setupComponent()})}}customElements.define("embed-youtube",e)})();})();
